<!DOCTYPE html>
<html lang="tr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Canlƒ± Piyasalar</title>
<style>
    body {
        font-family: Arial, sans-serif;
        background-color: #f4f4f4;
        margin: 0;
        padding: 0;
    }
    header {
        background: #222;
        color: #fff;
        padding: 10px;
        text-align: center;
        font-size: 1.2em;
        position: sticky;
        top: 0;
        z-index: 100;
    }
    .tabs {
        display: flex;
        justify-content: center;
        background: #fff;
        box-shadow: 0 2px 5px rgba(0,0,0,0.1);
    }
    .tab {
        padding: 10px 20px;
        cursor: pointer;
        border: none;
        background: none;
        font-size: 1em;
    }
    .tab.active {
        border-bottom: 3px solid #ff9800;
        font-weight: bold;
    }
    .container {
        max-width: 900px;
        margin: auto;
        padding: 15px;
    }
    .card {
        background: #fff;
        padding: 15px;
        margin-bottom: 10px;
        border-radius: 8px;
        box-shadow: 0 2px 5px rgba(0,0,0,0.1);
        display: flex;
        justify-content: space-between;
        align-items: center;
    }
    .code {
        font-weight: bold;
        font-size: 1.1em;
    }
    .prices {
        text-align: right;
    }
    .update-time {
        font-size: 0.9em;
        color: #ccc;
        margin-top: 5px;
    }
</style>
</head>
<body>

<header>
    üí± Canlƒ± Piyasalar  
    <div class="update-time" id="update-time">Son G√ºncelleme: -</div>
</header>

<div class="tabs">
    <button class="tab active" onclick="showTab('doviz')">üí± D√∂viz</button>
    <button class="tab" onclick="showTab('altin')">üèÖ Altƒ±n & G√ºm√º≈ü</button>
</div>

<div class="container" id="data-container"></div>

<script>
const apiURL = "https://lingering-scene-da42.mehmetklc1907.workers.dev/";

// Kod listeleri
const dovizList = ["USDTRY","EURTRY","GBPTRY","CHFTRY","AUDTRY","CADTRY","SARTRY","DKKTRY","SEKTRY","NOKTRY","JPYTRY","EURUSD","USDJPY","USDCAD","USDCHF","GBPUSD","AUDUSD"];
const altinList = ["ALTIN","KULCEALTIN","ONS","AYAR22","AYAR14","CEYREK_YENI","CEYREK_ESKI","YARIM_YENI","YARIM_ESKI","TEK_YENI","TEK_ESKI","ATA_YENI","ATA_ESKI","ATA5_YENI","ATA5_ESKI","GREMESE_YENI","GREMESE_ESKI","GUMUSTRY","GUMUSUSD","XAGUSD","XAUXAG"];

let currentTab = "doviz";

function fetchData() {
    fetch(apiURL)
    .then(res => res.json())
    .then(json => {
        const data = json.data;
        document.getElementById("update-time").textContent = "Son G√ºncelleme: " + Object.values(data)[0].tarih;
        renderData(data);
    })
    .catch(err => console.error(err));
}

function renderData(data) {
    const container = document.getElementById("data-container");
    container.innerHTML = "";
    
    let list = currentTab === "doviz" ? dovizList : altinList;
    
    list.forEach(code => {
        if(data[code]) {
            let alis = parseFloat(data[code].alis);
            let satis = parseFloat(data[code].satis);
            
            // D√∂viz 3 hane, Altƒ±n 2 hane
            if(currentTab === "doviz") {
                alis = alis.toFixed(3);
                satis = satis.toFixed(3);
            } else {
                alis = alis.toFixed(2);
                satis = satis.toFixed(2);
            }
            
            container.innerHTML += `
                <div class="card">
                    <div class="code">${code}</div>
                    <div class="prices">
                        <div>Alƒ±≈ü: ${alis}</div>
                        <div>Satƒ±≈ü: ${satis}</div>
                    </div>
                </div>
            `;
        }
    });
}

function showTab(tab) {
    currentTab = tab;
    document.querySelectorAll(".tab").forEach(btn => btn.classList.remove("active"));
    document.querySelector(`.tab:nth-child(${tab === "doviz" ? 1 : 2})`).classList.add("active");
    fetchData();
}

fetchData();
setInterval(fetchData, 10000);
</script>

</body>
</html>
